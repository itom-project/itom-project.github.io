

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.5. DispWindow &mdash; itom Documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.6. GLDisplay" href="glDisplay.html" />
    <link rel="prev" title="3.4. SuperlumBS" href="SuperlumBS.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> itom Plugins
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../grabbers.html">1. Camera/ Grabber</a></li>
<li class="toctree-l1"><a class="reference internal" href="../actuators.html">2. Motors/ Actuators</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../GDIO.html">3. General Data IO</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CyUSB.html">3.1. CyUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="LibModBus.html">3.2. LibModBus</a></li>
<li class="toctree-l2"><a class="reference internal" href="SuperlumBL.html">3.3. SuperlumBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="SuperlumBS.html">3.4. SuperlumBS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.5. DispWindow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">3.5.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialization">3.5.2. Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">3.5.3. Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gamma-correction">3.5.4. Gamma correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-current-view-to-image-file">3.5.5. Save current view to image file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="glDisplay.html">3.6. GLDisplay</a></li>
<li class="toctree-l2"><a class="reference internal" href="gwInstekPSP.html">3.7. GWInstekPSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="hidApi.html">3.8. HidApi</a></li>
<li class="toctree-l2"><a class="reference internal" href="libUSB.html">3.9. LibUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="serialIO.html">3.10. SerialIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="thorlabsPowerMeter.html">3.11. Thorlabs Power Meter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../adconv.html">4. AD-Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms.html">5. Algorithms/ Filters</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">itom Plugins</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../GDIO.html">3. General Data IO</a> &raquo;</li>
        
      <li>3.5. DispWindow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/plugins/generalDataIO/dispWindow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dispwindow">
<h1>3.5. DispWindow<a class="headerlink" href="#dispwindow" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Summary</strong>:</td>
<td><span>Window for SLM/LCD-Applications</span></td>
</tr>
<tr class="row-even"><td><strong>Type</strong>:</td>
<td><span>DataIO</span></td>
</tr>
<tr class="row-odd"><td><strong>License</strong>:</td>
<td><span>LGPL</span></td>
</tr>
<tr class="row-even"><td><strong>Platforms</strong>:</td>
<td>Windows, Linux</td>
</tr>
<tr class="row-odd"><td><strong>Devices</strong>:</td>
<td>OpenGL based widget to show cosine and graycode sequences</td>
</tr>
<tr class="row-even"><td><strong>Author</strong>:</td>
<td><span>C. Kohler, ITO, University Stuttgart</span></td>
</tr>
</tbody>
</table>
<div class="section" id="overview">
<h2>3.5.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This plugin opens a borderless window at a given position and displays horizontal or vertical cosine fringes including various graycode fringes (for unwrapping). The visualization is done with the help of OpenGL and the open source library GLEW.</p>
<p>For building this plugin, download (the binaries) of glew from <a class="reference external" href="http://glew.sourceforge.net/">http://glew.sourceforge.net/</a> and set the variable GLEW_DIR in CMake to the corresponding folder. The necessary library will finally be copied to the lib-folder of itom such that an entry in the environment variable path is not necessary. Please make sure, that you use always the same version of glew for all plugins that require this library.</p>
</div>
<div class="section" id="initialization">
<h2>3.5.2. Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>The following parameters are mandatory or optional for initializing an instance of this plugin:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt><strong>x0</strong>: {int, optional} [-4096,4096], default: 0, step: 1</dt>
<dd>x0 position of window</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>y0</strong>: {int, optional} [-4096,4096], default: 0, step: 1</dt>
<dd>y0 position of window</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>xsize</strong>: {int, optional} [3,4096], default: 3, step: 1</dt>
<dd>height of window</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>ysize</strong>: {int, optional} [3,4096], default: 3, step: 1</dt>
<dd>width of window</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>period</strong>: {int, optional} [4,4096], default: 12, step: 2</dt>
<dd>cosine period in pixel</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>phaseshift</strong>: {int, optional} [3,8], default: 4, step: 1</dt>
<dd>number of total phase shifts</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>lut</strong>: {seq. of int (char), optional}</dt>
<dd>Lookup table for a gamma correction with 256 values. If given, the gamma correction will be enabled (default: off) and the projected values are then modified with lut[value].</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>dObj</strong>: {dataObject, optional}</dt>
<dd>DataObject with pixel values to display</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="parameters">
<h2>3.5.3. Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>Every instance of this plugin has the following parameters:</p>
<dl class="docutils">
<dt><strong>color</strong>: {int}</dt>
<dd>0: Red, 1: Green, 2: Blue, 3: White</dd>
<dt><strong>gamma</strong>: {int}</dt>
<dd>0: disable gamma correction, 1: enable gamma correction; default disable (see also ‘lut’)</dd>
<dt><strong>lut</strong>: {seq. of int (char)}</dt>
<dd>Lookup table for a gamma correction with 256 values. The gamma correction itself is en-/disabled via parameter ‘gamma’. If enabled, the value to display is modified by lut[value]. Per default the lut is a 1:1 relation.</dd>
<dt><strong>name</strong>: {str}, read-only</dt>
<dd>name of the plugin</dd>
<dt><strong>numgraybits</strong>: {int}, read-only</dt>
<dd>Number of different images: Phaseshift + GrayCode + 2</dd>
<dt><strong>numimg</strong>: {int}</dt>
<dd>Number of current image (phase images, dark image, bright image, graycode images)</dd>
<dt><strong>orientation</strong>: {int}</dt>
<dd>0: vertical, 1: horizontal; default: vertical</dd>
<dt><strong>period</strong>: {int}</dt>
<dd>Cosine period in pixel. This must be a multiple of 2 and the number of ‘phaseshift’.</dd>
<dt><strong>phaseshift</strong>: {int}</dt>
<dd>Count of phase shifts. If this value is changed and the ‘period’ does not fit to the new value, the ‘period’ is adapted to the next possible value.</dd>
<dt><strong>x0</strong>: {int}</dt>
<dd>x0 position of display window [px]</dd>
<dt><strong>xsize</strong>: {int}</dt>
<dd>width of window [px]</dd>
<dt><strong>y0</strong>: {int}</dt>
<dd>y0 position of display window [px]</dd>
<dt><strong>ysize</strong>: {int}</dt>
<dd>height of window [px]</dd>
</dl>
</div>
<div class="section" id="gamma-correction">
<h2>3.5.4. Gamma correction<a class="headerlink" href="#gamma-correction" title="Permalink to this headline">¶</a></h2>
<p>If the parameter <em>gamma</em> is set to 0, no further gamma correction is enabled. This means, that the gray values of the cosine fringes are
directly displayed as they are using a 8bit resolution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">screen_pixel</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>However, if your camera and projector has a non-linear behaviour between displayed and detected gray value, a gamma correction can and should
be enabled. Then, the displayed gray value is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">screen_pixel</span> <span class="o">=</span> <span class="n">lut</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])]</span>
</pre></div>
</div>
<p>The lookup table (lut) consists of 256 values. In order to register the lookup table, you can project a uniform background with uniformly distributed
gray-values (at least 64 different values) between 0 and full resolution (e.g. 255). The values should be sorted beginning with the darkest one until ‘white’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">projector</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;projectGrayValue&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">displaying any other image (graycode or cosine fringe) will clear the gray valued image</p>
</div>
<p>Then, record every uniform projection with the camera and determine the mean gray value. You then get a list of gray values, like the following one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="o">...</span> <span class="mi">198</span><span class="p">]</span>
</pre></div>
</div>
<p>Call the <strong>exec</strong> function <strong>calcLut</strong> and pass <em>g</em> in order to let the plugin calculate the <em>lut</em> (based on a linear interpolation if <em>g</em> contains less values
than 256):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">projector</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;calcLut&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, you need to enable the gamma correction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">projector</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the <em>lut</em> (parameter <em>lut</em>) contains values, such that the recorded gray values applying the same uniformly distributed background images are linearly distributed.</p>
</div>
<div class="section" id="save-current-view-to-image-file">
<h2>3.5.5. Save current view to image file<a class="headerlink" href="#save-current-view-to-image-file" title="Permalink to this headline">¶</a></h2>
<p>Use the exec function <strong>grabFramebuffer</strong> to save the currently displayed view in the same size to an image file (the file type is determined by the file’s ending (file type must be
supported by Qt’s QImage):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">projector</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;grabFramebuffer&quot;</span><span class="p">,</span> <span class="s2">&quot;D:/test.pgm&quot;</span><span class="p">)</span> <span class="c1">#or</span>
<span class="n">projector</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;grabFramebuffer&quot;</span><span class="p">,</span> <span class="s2">&quot;D:/test.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="glDisplay.html" class="btn btn-neutral float-right" title="3.6. GLDisplay" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="SuperlumBS.html" class="btn btn-neutral" title="3.4. SuperlumBS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2018, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://bitbucket.org/itom/itom/issues
      Last updated on Nov 29, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>