<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.6. Thorlabs Power Meter &mdash; itom Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Algorithms/ Filters" href="../algorithms.html" />
    <link rel="prev" title="4.5. NI-DAQmx" href="niDAQmx.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> itom Plugins
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../grabbers.html">1. Camera/ Grabber</a></li>
<li class="toctree-l1"><a class="reference internal" href="../actuators.html">2. Motors/ Actuators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GDIO.html">3. General Data IO</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../adconv.html">4. AD-Converters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="HBMSpider8.html">4.1. HBMSpider8</a></li>
<li class="toctree-l2"><a class="reference internal" href="MeasurementComputing.html">4.2. MeasurementComputing</a></li>
<li class="toctree-l2"><a class="reference internal" href="OphirPowermeter.html">4.3. OphirPowermeter</a></li>
<li class="toctree-l2"><a class="reference internal" href="ThorlabsKCubePA.html">4.4. Thorlabs KCube Position Aligner</a></li>
<li class="toctree-l2"><a class="reference internal" href="niDAQmx.html">4.5. NI-DAQmx</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.6. Thorlabs Power Meter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">4.6.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialization">4.6.2. Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">4.6.3. Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-functions-exec-functions">4.6.4. Additional functions (exec functions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">4.6.5. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compilation">4.6.6. Compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemplary-usage-from-python">4.6.7. Exemplary usage from Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changelog">4.6.8. Changelog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms.html">5. Algorithms/ Filters</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">itom Plugins</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../adconv.html"><span class="section-number">4. </span>AD-Converters</a> &raquo;</li>
      <li><span class="section-number">4.6. </span>Thorlabs Power Meter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/plugins/ad-converters/thorlabsPowerMeter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thorlabs-power-meter">
<h1><span class="section-number">4.6. </span>Thorlabs Power Meter<a class="headerlink" href="#thorlabs-power-meter" title="Permalink to this heading"></a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Summary</strong>:</p></td>
<td><p><span>ThorlabsPowerMeter</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Type</strong>:</p></td>
<td><p><span>DataIO</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>License</strong>:</p></td>
<td><p><span>LPGL, uses Thorlabs CCS VISA Instrument Driver (LGPL licensed)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Platforms</strong>:</p></td>
<td><p>Windows</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Devices</strong>:</p></td>
<td><p>Thorlabs Power and Energy Meter Consoles PM100x</p></td>
</tr>
<tr class="row-even"><td><p><strong>Author</strong>:</p></td>
<td><p><span>Robin Hahn, ITO, University Stuttgart</span></p></td>
</tr>
</tbody>
</table>
<section id="overview">
<h2><span class="section-number">4.6.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>This plugin can be used to control any Thorlabs PM100x, PM200 or PM400 Power Console with a connected photodiode power sensors. Other sensors like thermal or pyroelectric sensors are currently not supported by this plugin.
If you start the plugin without further parameters (device=’’), the first connected device is opened.
Set device = ‘&lt;scan&gt;’ in order to get a printed list of detected devices. Use the device string or the desired
device in order to open this specific one.</p>
<p>The plugin was tested with a PM100A console and a standard photodiode power sensor.</p>
<p>This plugin gives full control over the connected device. For high attenuation there is a known issue when setting the power range via the slider widget (this belongs to the great range of possible values) in the config dialog or the dock widget.The power range is at any time fully accessible over the setParam command.</p>
<p>For compiling this plugin, you need to install the Thorlabs PM100x Instrument Driver or the Optical Power Meter Utility (including the driver) , shipped with the spectrometer.
Then set the CMake variable Thorlabs_IVI_VISA_INCLUDE_DIR to the include directory (e.g. C:/Program Files/IVI Foundation/VISA/Win64/Include)</p>
</section>
<section id="initialization">
<h2><span class="section-number">4.6.2. </span>Initialization<a class="headerlink" href="#initialization" title="Permalink to this heading"></a></h2>
<p>The following parameters are mandatory or optional for initializing an instance of this plugin:</p>
<blockquote>
<div><ul>
<li><dl>
<dt><strong>device</strong>: str, optional</dt><dd><p>device name that should be opened, an empty string opens the first device that is found (default). Pass ‘&lt;scan&gt;’ for displaying all detected devices.</p>
<p><em>default: “”</em></p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</section>
<section id="parameters">
<h2><span class="section-number">4.6.3. </span>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt><strong>attenuation</strong>: {float}</dt><dd><p>attenuation [db]</p>
</dd>
<dt><strong>auto_range</strong>: {int}</dt><dd><p>shows if the auto power range is wether on (1) or off(2)</p>
</dd>
<dt><strong>average_number</strong>: {int}</dt><dd><p>defines the number of measurements to be averaged</p>
</dd>
<dt><strong>bandwidth</strong>: {int}</dt><dd><p>defines if the input filter state is whether High (0) or Low (1)</p>
</dd>
<dt><strong>calibration_message</strong>: {str}, read-only</dt><dd><p>calibration message</p>
</dd>
<dt><strong>dark_offset</strong>: {float}, read-only</dt><dd><p>setted dark offset [unknown]</p>
</dd>
<dt><strong>device_name</strong>: {str}, read-only</dt><dd><p>device name</p>
</dd>
<dt><strong>firmware_revision</strong>: {str}, read-only</dt><dd><p>firmware revision</p>
</dd>
<dt><strong>line_frequency</strong>: {int}</dt><dd><p>line frequency of 50Hz or 60Hz</p>
</dd>
<dt><strong>manufacturer_name</strong>: {str}, read-only</dt><dd><p>manufacturer name</p>
</dd>
<dt><strong>measurement_mode</strong>: {str}</dt><dd><p>absolute or relative</p>
</dd>
<dt><strong>name</strong>: {str}, read-only</dt><dd><p>name of the device</p>
</dd>
<dt><strong>power_range</strong>: {float}</dt><dd><p>power range [W]; will be set to the next bigger possible value</p>
</dd>
<dt><strong>reference_power</strong>: {float}</dt><dd><p>reference power for relative measurements</p>
</dd>
<dt><strong>serial_number</strong>: {str}, read-only</dt><dd><p>serial number</p>
</dd>
<dt><strong>wavelength</strong>: {float}</dt><dd><p>wavelength [nm]</p>
</dd>
</dl>
</section>
<section id="additional-functions-exec-functions">
<h2><span class="section-number">4.6.4. </span>Additional functions (exec functions)<a class="headerlink" href="#additional-functions-exec-functions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="instance.exec">
<span class="sig-prename descclassname"><span class="pre">instance.</span></span><span class="sig-name descname"><span class="pre">exec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">'zero_device'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#instance.exec" title="Permalink to this definition"></a></dt>
<dd><p>function to set the zero value of the device</p>
</dd></dl>

</section>
<section id="installation">
<h2><span class="section-number">4.6.5. </span>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>For using this plugin, please install the PM100x_Instrument_Driver that is shipped with the Thorlabs power meter.</p>
</section>
<section id="compilation">
<h2><span class="section-number">4.6.6. </span>Compilation<a class="headerlink" href="#compilation" title="Permalink to this heading"></a></h2>
<p>It is possible to use the Thorlabs power meter with the legacy Thorlabs software <strong>ThorlabsPowerMeter_1.0.2</strong>
(see <a class="reference external" href="https://www.thorlabs.de/software_pages/ViewSoftwarePage.cfm?Code=PM100x">https://www.thorlabs.de/software_pages/ViewSoftwarePage.cfm?Code=PM100x</a>). Install this software and set the
following CMake variables:</p>
<ul class="simple">
<li><p>THORLABS_POWER_METER_API_VERSION: 1.02</p></li>
<li><p>THORLABS_PM100D_VISA_DIR: &lt;path to the install directory of Thorlabs PM100D Visa, e.g. C:/Program Files/IVI Foundation/VISA/Win64&gt;</p></li>
</ul>
<p>Alternatively you can use the Thorlabs Optical Power Meter Monitor Software <strong>Thorlabs.OpticalPowerMonitor.1.1</strong>
(see <a class="reference external" href="https://www.thorlabs.de/software_pages/ViewSoftwarePage.cfm?Code=OPM">https://www.thorlabs.de/software_pages/ViewSoftwarePage.cfm?Code=OPM</a>). Install this software and set the
CMake variables to the following values:</p>
<ul class="simple">
<li><p>THORLABS_POWER_METER_API_VERSION: 1.1</p></li>
<li><p>THORLABS_PM100D_VISA_DIR: &lt;path to the install directory of Thorlabs PM100D Visa, e.g. C:/Program Files/IVI Foundation/VISA/Win64&gt;</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to change the version of an existing configuration, please remove all related THORLABS_PM100D… variables, set the
new version and press configure.</p>
</div>
</section>
<section id="exemplary-usage-from-python">
<h2><span class="section-number">4.6.7. </span>Exemplary usage from Python<a class="headerlink" href="#exemplary-usage-from-python" title="Permalink to this heading"></a></h2>
<p>In the following script, the first detectable power meter is connected and a oscilloscope-like
plot is opened that displays a moving graph of recent intensity values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;pmXXX&quot;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
<span class="n">pmXXX</span> <span class="o">=</span> <span class="n">dataIO</span><span class="p">(</span><span class="s2">&quot;ThorlabsPowerMeter&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">numPoints</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">dataObject</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">numPoints</span><span class="p">],</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">plot_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot1</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timeout</span><span class="p">():</span>
            <span class="k">global</span> <span class="n">timer_id</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dataObject</span><span class="p">()</span>
            <span class="n">pmXXX</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span> <span class="c1">#acquire new intensity value</span>

            <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">numPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span> <span class="c1">#shift pixels to the left by one...</span>

            <span class="n">pmXXX</span><span class="o">.</span><span class="n">getVal</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="c1">#get the recently acquired value</span>
            <span class="n">image</span><span class="o">.</span><span class="n">copyMetaInfo</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">numPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#...append new value to the end of image</span>

            <span class="k">if</span> <span class="n">plot_handle</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                            <span class="n">plot_handle</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">image</span> <span class="c1">#update the displayed image</span>
                    <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure has been closed. Stop acquisition...&quot;</span><span class="p">)</span>
                    <span class="n">timer_id</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">timer_id</span>

    <span class="n">timer_id</span> <span class="o">=</span> <span class="n">timer</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span> <span class="c1">#call timeout every 50ms</span>
</pre></div>
</div>
</section>
<section id="changelog">
<h2><span class="section-number">4.6.8. </span>Changelog<a class="headerlink" href="#changelog" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>itom 3.0.0: plugin uses the driver PM100x_Instrument_Driver in version 3.0.2</p></li>
<li><p>itom 3.1.0: plugin uses the driver PM100x_Instrument_Driver in version 1.0.2 (Thorlabs has changed the major version number again)</p></li>
<li><p>Due to the chaotic version handling of Thorlabs PowerMeter, the source code is changed such that only version 3.0.2 is no longer supported.</p></li>
<li><p>itom 3.2.1: plugin uses the driver PM100x_Instrument_Driver in version 1.1.2317.102</p></li>
<li><p>itom 4.0.0: plugin uses the driver PM100x_Instrument_Driver in version 2.2</p></li>
<li><p>itom 4.1.0: plugin uses the driver PM100x_Instrument_Driver in version 2.2</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="niDAQmx.html" class="btn btn-neutral float-left" title="4.5. NI-DAQmx" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../algorithms.html" class="btn btn-neutral float-right" title="5. Algorithms/ Filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://bitbucket.org/itom/itom/issues.
      <span class="lastupdated">Last updated on Jul 15, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>