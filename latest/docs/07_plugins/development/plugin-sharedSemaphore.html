

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8.8.2. ItomSharedSemaphore &#8212; itom Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '07_plugins/development/plugin-sharedSemaphore';</script>
    <link rel="icon" href="../../_static/itomLogo3_128.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.8.2.1.1. ItomSharedSemaphore - Reference" href="plugin-sharedSemaphore-Ref.html" />
    <link rel="prev" title="8.8.1.1. RetVal - Reference" href="plugin-RetVal-Ref.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/itomLogo3_128.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/itomLogo3_128.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../00_releaseNotes/whats-new.html">
                        Changelog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../01_introduction/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../02_installation/install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../03_gettingStarted/getting-started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../04_itom_gui/gui.html">
                        The itom User Interface
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../05_plots/plots.html">
                        Plots and Figures
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../06_extended_gui/extended_gui.html">
                        Extending the user interface of itom
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../plugins.html">
                        Plugins
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../08_scriptLanguage/script-language.html">
                        Python Scripting Language
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../09_reference/reference.html">
                        itom Script Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../10_miscellaneous/miscellaneous.html">
                        Miscellaneous
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../11_demos/demos.html">
                        Demo scripts
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../12_contributing/contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/itom-project" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.ito.uni-stuttgart.de/" title="ITO" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/ITO_Logo_neu_II.png" class="icon-link-image" alt="ITO"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../00_releaseNotes/whats-new.html">
                        Changelog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../01_introduction/introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../02_installation/install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../03_gettingStarted/getting-started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../04_itom_gui/gui.html">
                        The itom User Interface
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../05_plots/plots.html">
                        Plots and Figures
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../06_extended_gui/extended_gui.html">
                        Extending the user interface of itom
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../plugins.html">
                        Plugins
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../08_scriptLanguage/script-language.html">
                        Python Scripting Language
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../09_reference/reference.html">
                        itom Script Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../10_miscellaneous/miscellaneous.html">
                        Miscellaneous
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../11_demos/demos.html">
                        Demo scripts
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../12_contributing/contributing.html">
                        Contributing
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/itom-project" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.ito.uni-stuttgart.de/" title="ITO" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/ITO_Logo_neu_II.png" class="icon-link-image" alt="ITO"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic_concept.html">8.1. Basic concept</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_plugins.html">8.2. Loading plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstart-hardware.html">8.3. How to use hardware plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstart-grabber.html">8.4. Getting started with grabbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstart-adda.html">8.5. Getting started with A/D converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstart-actuator.html">8.6. Getting started with actuators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstart-filter.html">8.7. Getting started with algorithm plugins (denoted as filters)</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="plugin-development.html">8.8. Development under C++</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plugin-RetVal.html">8.8.1. <strong>RetVal</strong> - The return type of <strong>itom</strong> methods</a></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">8.8.2. ItomSharedSemaphore</a><input checked class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="plugin-sharedSemaphore-Ref.html">8.8.2.1.1. ItomSharedSemaphore - Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugin-dataObject.html">8.8.3. DataObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-params.html">8.8.4. Parameter-Container class of <strong>itom</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-paramsMeta.html">8.8.5. Parameters - Meta Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-paramsValidate.html">8.8.6. Parameters - Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginStructure.html">8.8.7. Introduction to plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginInterfaceClass.html">8.8.8. Plugin interface class</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-AddInBase-Ref.html">8.8.9. AddInBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginClass.html">8.8.10. Plugin class - Basic information</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-dataIO.html">8.8.11. Plugin class - DataIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-actuator.html">8.8.12. Plugin class - Actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-algo.html">8.8.13. Plugin class - Algo</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginCreateCMake.html">8.8.14. Create a new plugin via CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginAutoLoadSavePolicy.html">8.8.15. Automatic loading and saving of plugin parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-itomAPI.html">8.8.16. itom API</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-externalLibraries.html">8.8.17. Link or load external libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="projectSettings.html">8.8.18. Project settings for plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-dockWidget.html">8.8.19. Optional dock widget (toolbox) for hardware plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-configDialog.html">8.8.20. Optional configuration dialog for hardware plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="openCVMat.html">8.9. OpenCV matrices <strong>cv::Mat</strong> and <strong>cv::Mat_</strong></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../plugins.html" class="nav-link"><span class="section-number">8. </span>Plugins</a></li>
    
    
    <li class="breadcrumb-item"><a href="plugin-development.html" class="nav-link"><span class="section-number">8.8. </span>Development under C++</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="section-number">8.8.2. </span>ItomSharedSemaphore</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="itomsharedsemaphore">
<span id="plugin-sharedsemaphore"></span><h1><span class="section-number">8.8.2. </span>ItomSharedSemaphore<a class="headerlink" href="#itomsharedsemaphore" title="Permalink to this heading">#</a></h1>
<p>In <strong>itom</strong> different main components are executed in different threads.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>What is a thread</strong></p>
<p>In a modern operating system, different programs can run simultaneously. Then, every program is executed in its own process and the operating system is responsible such that each process continuously gets some processing-time on the processor. If your computer has multiple processors, than the operating system can assign processing time of different processes to different processing units.</p>
<p>Every program itself can now run different components of its own software in different threads. Thread are comparable to processes on operating system level, however threads can share memory, such that every thread can have access to a common set of global variables, instances… The advantage is, that a thread can execute a time-consuming calculation while the other thread is responsible for the graphical user interfaces, which now is not blocked while the calculation thread is working.</p>
<p>For more information about threads see <a class="reference external" href="http://en.wikipedia.org/wiki/Thread_%28computing%29">Wikipedia (english)</a> or <a class="reference external" href="http://de.wikipedia.org/wiki/Thread_%28Informatik%29">Wikipedia (german)</a></p>
</div>
<p>In <strong>itom</strong>, the following components run into a different thread:</p>
<ol class="arabic simple">
<li><p>Main programm including all graphical user interface components (this is a restricting of windows operating systems). This thread is called “main thread”.</p></li>
<li><p>Python scripting engine. All python scripts are executed in a second thread. Therefore you should not directly use any 3rd-party python modules which open any graphical user interface (like <em>PyQt</em>, <em>tkInter</em> …).</p></li>
<li><p>Every <em>DataIO</em> or <em>Actuator</em>-plugin is executed in its own thread. Every algorithm is executed in the thread of the calling instance (e.g. main thread or python thread). All widgets provided by any <em>Algo</em>-plugin are always executed in the <em>main thread</em> (see restricting of point 1).</p></li>
</ol>
<figure class="align-center" id="id1">
<span id="plugin-sharedsemaphore-scheme"></span><a class="reference internal image-reference" href="../../_images/itomSharedSemaphore750.png"><img alt="../../_images/itomSharedSemaphore750.png" src="../../_images/itomSharedSemaphore750.png" style="width: 750.0px; height: 681.0px;" /></a>
<figcaption>
<p><span class="caption-text">Figure: Scheme of a communication between <strong>itom</strong> (main thread) and any plugin-method (plugin is running in another thread)</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In figure <a class="reference internal" href="#plugin-sharedsemaphore-scheme"><span class="std std-ref">Figure: Scheme of a communication between itom (main thread) and any plugin-method (plugin is running in another thread)</span></a>, a common communcation between a method <strong>mainfunc</strong> which is executed in <strong>itom</strong>’s main thread (e.g. in <em>AddInManager</em> and another method <strong>func1</strong> of a plugin is depicted. The plugin is of type <em>actuator</em> or <em>dataIO</em> and therefore runs in its own thread. <strong>mainfunc</strong> is calling the method <strong>func1</strong>. Usually the calling method has to wait until the called method (<strong>func1</strong>) has been finished (or until the most important parts of <strong>func1</strong> have been executed). In order to consider cases where the plugin-method is not answering within a certain timeout, <strong>itom</strong> has integrated a mechanism such that the waiting-process in the main-function can be stopped after that the timeout time expired. This mechanism is realized by the class <strong>ItomSharedSemaphore</strong>, which is definined in the file <em>sharedStructuresQt.h</em> (folder <em>common</em>).</p>
<p><strong>ItomSharedSemaphore</strong> consists of the following elements:</p>
<dl class="c member">
<dt class="sig sig-object c" id="c.m_pSemaphore">
<span class="n"><span class="pre">QSemaphore</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">m_pSemaphore</span></span></span><a class="headerlink" href="#c.m_pSemaphore" title="Permalink to this definition">#</a><br /></dt>
<dd><p>ItomSharedSemaphore internally contains an instance of <em>QSemaphore</em>, the platform independent semaphore provided by <strong>Qt</strong>. A semaphore can been considered as set of <em>gaming piece</em>. Any method executed within different threads can take one or more <em>gaming pieces</em> from the common semaphore. If there are not enough <em>gaming piece</em> in the storage, the method has to wait until the necessary number of <em>gaming pieces</em> become available. Any method which exits some “critical sections” in the code release their previously picked <em>gaming pieces</em>, such that other instances can repick them. In most cases in the communcation between <strong>itom</strong> and a plugin-method, the semaphore contains one <em>gaming piece</em>, since only two partners are participating in the communication: the method in the main thread and the called method in the plugin-thread. The method in the plugin-thread is picking the <em>gaming piece</em> and the calling method has to wait until the <em>gaming piece</em> gets back to the storage of the semaphore. This is achieved by <em>releasing</em> the <em>gaming piece</em> in the called method.</p>
</dd></dl>

<dl class="c member">
<dt class="sig sig-object c" id="c.m_numOfListeners">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">m_numOfListeners</span></span></span><a class="headerlink" href="#c.m_numOfListeners" title="Permalink to this definition">#</a><br /></dt>
<dd><p>This is the number of participants at a communcation process (without the calling method). Usually only one method is called, therefore this value is usually equal to 1. This value usually is automatically set.</p>
</dd></dl>

<dl class="c member">
<dt class="sig sig-object c" id="c.m_instCounter">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">m_instCounter</span></span></span><a class="headerlink" href="#c.m_instCounter" title="Permalink to this definition">#</a><br /></dt>
<dd><p>This value indicates how many <em>gaming pieces</em> are out of the storage. If the called method is still executing, this value is equal to one. If the called method already release the semaphore, hence <em>gaming piece</em>, the value drops to zero.</p>
</dd></dl>

<dl class="c member">
<dt class="sig sig-object c" id="c.isCallerStillWaiting">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isCallerStillWaiting</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.isCallerStillWaiting" title="Permalink to this definition">#</a><br /></dt>
<dd><p>This method returns true if the calling method (<em>here</em>: the method in main thread) is still waiting that the called method has released the semaphore, else the method returns false.</p>
</dd></dl>

<dl class="c member">
<dt class="sig sig-object c">
<span class="sig-name descname"><span class="pre">ito::RetVal</span> <span class="pre">returnValue</span></span></dt>
<dd><p>The called method in the plugin-thread can set that globally accessible return value and the calling method can read its value. That return value is the single way to return the success or error message to the calling method, since no return value of the called method (slot) can directly be returned.</p>
</dd></dl>

<section id="scheme-of-the-inter-thread-communication">
<h2><span class="section-number">8.8.2.1. </span>Scheme of the inter-thread communication<a class="headerlink" href="#scheme-of-the-inter-thread-communication" title="Permalink to this heading">#</a></h2>
<ol class="arabic">
<li><p>The calling method <strong>mainfunc</strong> creates an instance of <em>ItomSharedSemaphore</em>:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ItomSharedSemaphore</span><span class="w"> </span><span class="o">*</span><span class="n">waitCond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ItomSharedSemaphore</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Method <strong>func1</strong> is called in the plugin-thread. This can only be done if <strong>func1</strong> is declared as <strong>slot</strong> (<em>signal-slot-system</em> of <strong>Qt</strong>). The call is executed using the method <strong>invokeMethod</strong> of <em>QMetaObject</em>:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">QMetaObject</span><span class="o">::</span><span class="n">invokeMethod</span><span class="p">(</span><span class="n">instance</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">plugin</span><span class="p">,</span><span class="s">&quot;func1&quot;</span><span class="p">,</span><span class="n">Q_ARG</span><span class="p">(</span><span class="n">paramType1</span><span class="p">,</span><span class="w"> </span><span class="n">paramValue1</span><span class="p">),...,</span><span class="n">Q_ARG</span><span class="p">(</span><span class="n">ItomSharedSemaphore</span><span class="o">*</span><span class="p">,</span><span class="n">waitCond</span><span class="p">))</span>
</pre></div>
</div>
<p>For the use of the macros <strong>Q_ARG</strong> and the method <strong>invokeMethod</strong>, see also the documentation of <strong>Qt</strong>.</p>
</div></blockquote>
</li>
<li><p>Then <strong>func1</strong> is executing and their last parameter <em>waitCond</em> contains the pointer to the instance of <em>ItomSharedSemaphore</em>.</p></li>
<li><p>If <strong>func1</strong> has been finished, you should write the return value to the instance of <em>waitCond</em> and release the semaphore, hence, return the <em>gaming piece</em> to the global storage of the semaphore:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">waitCond</span><span class="p">)</span><span class="w"> </span><span class="c1">//can also be NULL, therefore check it</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">returnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ito</span><span class="o">::</span><span class="n">RetVal</span><span class="p">(</span><span class="n">ito</span><span class="o">::</span><span class="n">retOk</span><span class="p">)</span>
<span class="w">    </span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">release</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The caller has to wait until the semaphore has been released or a timeout expired. This is done by the member <strong>wait</strong> of <strong>ItomSharedSemaphore</strong>. The single argument of that method is the timeout in milliseconds. Usually you can use the global variable <strong>PLUGINWAIT</strong>, which is set to <strong>5 seconds</strong>. The <em>wait</em>-method returns <em>true</em> if the semaphore has been released within the timeout, else it returns false:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">wait</span><span class="p">(</span><span class="n">PLUGINWAIT</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//timeout occurred</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<ol class="arabic" start="5">
<li><p>Finally all participants at the communcation process (<em>here</em>: caller and called method) have to delete the semaphore. Be careful: This can not be done by simply <strong>deleting the pointer to waitCond</strong>. Instead both the caller and the called method have to execute the following command, hence, call the method <strong>deleteSemaphore</strong> of the semaphore pointer:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">deleteSemaphore</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>After that the last participant at the communcation process deleted the semaphore, it is really deleted by <strong>itom</strong>. Then you don’t have access to the semaphore any more, hence, you also don’t have access to the internal return value.</p></li>
</ol>
<p>In order to simplify the process of deleting the semaphore, both the caller and the calling method can also create a variable of type <strong>ItomSharedSemaphoreLocker</strong>, where the pointer to <strong>waitCond</strong> has to be given as constructor-argument. If this variable finally is destroyed, which is automatically done if the method is finished - even after that the <em>return</em> command has been executed - it calles the <em>deleteSemaphore</em>-method of <em>ItomSharedSemaphore</em> with <em>waitCond</em> as argument.</p>
<p>Then the scheme of the caller is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ItomSharedSemaphoreLocker</span><span class="w"> </span><span class="n">locker</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ItomSharedSemaphore</span><span class="p">())</span>
<span class="n">QMetaObject</span><span class="o">::</span><span class="n">invokeMethod</span><span class="p">(</span><span class="n">plugin</span><span class="o">-</span><span class="n">instance</span><span class="p">,</span><span class="s">&quot;func1&quot;</span><span class="p">,</span><span class="n">Q_ARG</span><span class="p">(</span><span class="n">paramType1</span><span class="p">,</span><span class="n">paramValue1</span><span class="p">),...,</span><span class="n">Q_ARG</span><span class="p">(</span><span class="n">ItomSharedSemaphore</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">locker</span><span class="p">.</span><span class="n">getSemaphore</span><span class="p">())</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">locker</span><span class="p">.</span><span class="n">getSemaphore</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">wait</span><span class="p">(</span><span class="n">PLUGINWAIT</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//timeout</span>
<span class="w">    </span><span class="n">retvalue</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ito</span><span class="o">::</span><span class="n">RetVal</span><span class="p">(</span><span class="n">ito</span><span class="o">::</span><span class="n">retError</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;timeout while executing method&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">retvalue</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">locker</span><span class="p">.</span><span class="n">getSemaphore</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">returnValue</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and the scheme of the called method <strong>func1</strong> is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">func1</span><span class="p">(</span><span class="n">type1</span><span class="w"> </span><span class="n">param1</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">ItomSharedSemaphore</span><span class="o">*</span><span class="w"> </span><span class="n">waitCond</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ItomSharedSemaphoreLocker</span><span class="w"> </span><span class="n">locker</span><span class="p">(</span><span class="n">waitCond</span><span class="p">)</span>
<span class="w">    </span><span class="p">...</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="p">...</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">waitCond</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">returnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ito</span><span class="o">::</span><span class="n">retOk</span><span class="p">;</span>
<span class="w">        </span><span class="n">waitCond</span><span class="o">-&gt;</span><span class="n">release</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information about the implementation of class <strong>ItomSharedSemaphore</strong> see <a class="reference internal" href="plugin-sharedSemaphore-Ref.html#plugin-itomsharedsemaphore-ref"><span class="std std-ref">ItomSharedSemaphore - Reference</span></a> or the doxygen documentation for <strong>itom</strong>.</p>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plugin-RetVal-Ref.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8.8.1.1. </span>RetVal - Reference</p>
      </div>
    </a>
    <a class="right-next"
       href="plugin-sharedSemaphore-Ref.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.8.2.1.1. </span>ItomSharedSemaphore - Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scheme-of-the-inter-thread-communication">8.8.2.1. Scheme of the inter-thread communication</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/07_plugins/development/plugin-sharedSemaphore.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2011-2023, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://bitbucket.org/itom/itom/issues.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>