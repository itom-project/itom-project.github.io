<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>12.1.10.8.26. Observe parallel functions &mdash; itom Documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="12.1.10.8.27. Measure tool" href="demo_uiMeasureToolMain.html" />
    <link rel="prev" title="12.1.10.8.25. UI shape" href="demo_uiShape.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> itom Documentation
          </a>
              <div class="version">
                4.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../00_releaseNotes/whats-new.html">1. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../01_introduction/introduction.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../02_installation/install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../03_gettingStarted/getting-started.html">4. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../04_itom_gui/gui.html">5. The itom User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../05_plots/plots.html">6. Plots and Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../06_extended_gui/extended_gui.html">7. Extending the user interface of <strong>itom</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../07_plugins/plugins.html">8. Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../08_scriptLanguage/script-language.html">9. Python Scripting Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../09_reference/reference.html">10. itom Script Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../10_miscellaneous/miscellaneous.html">11. Miscellaneous</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../demos.html">12. Demo scripts</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">12.1. itom</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#basics">12.1.1. Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#data-processing">12.1.2. Data processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#matplotlib-embedded">12.1.3. Matplotlib embedded</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#itom-apps">12.1.4. itom apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#plots">12.1.5. Plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#plugins">12.1.6. Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#pointcloud">12.1.7. PointCloud</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#user-interface">12.1.8. User interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#customize-itom-gui">12.1.9. Customize itom GUI</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#user-interface-dynamic-layouts">12.1.10. User interface dynamic layouts</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../basics/index.html">12.1.10.1. Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataProcessing/index.html">12.1.10.2. Data processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../embeddedMatplotlib/index.html">12.1.10.3. Matplotlib embedded</a></li>
<li class="toctree-l4"><a class="reference internal" href="../itom_apps/index.html">12.1.10.4. itom apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plots/index.html">12.1.10.5. Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plugins/index.html">12.1.10.6. Plugins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pointClouds/index.html">12.1.10.7. PointCloud</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">12.1.10.8. User interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ui_customize/index.html">12.1.10.9. Customize itom GUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ui_dynamicLayout/index.html">12.1.10.10. User interface dynamic layouts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../python/index.html">12.2. Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python_packages/index.html">12.3. Python packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../12_contributing/contributing.html">13. Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">itom Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../demos.html"><span class="section-number">12. </span>Demo scripts</a> &raquo;</li>
          <li><a href="../index.html"><span class="section-number">12.1. </span>itom</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">12.1.10.8. </span>User interface</a> &raquo;</li>
      <li><span class="section-number">12.1.10.8.26. </span>Observe parallel functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/11_demos/itom/ui/demo_observedParallelFunctions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-11-demos-itom-ui-demo-observedparallelfunctions-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="observe-parallel-functions">
<span id="sphx-glr-11-demos-itom-ui-demo-observedparallelfunctions-py"></span><h1><span class="section-number">12.1.10.8.26. </span>Observe parallel functions<a class="headerlink" href="#observe-parallel-functions" title="Permalink to this heading">¶</a></h1>
<p>This demo shows how to use a customized progressObserver to observer and
possibly cancel multiple ‘complex’ function calls, that are executed in
parallel in four different background threads.</p>
<p>Each single function call has its own progressObserver (member observer of class
FunctionCall). Additionally, there is one major progressObserver, that tracks
the total state of all coomplex functions call (each lasting for 10 seconds).</p>
<p>In this demo script, we do not only use the pre-defined possibilities of
the class <code class="docutils literal notranslate"><span class="pre">itom.progressObserver</span></code> to show the current progress value and
text in a given <code class="docutils literal notranslate"><span class="pre">itom.uiItem</span></code> of the GUI, but we use the
<code class="docutils literal notranslate"><span class="pre">itom.progressObserver.connect</span></code> method to connect different callable python
methods to signals of the progressObserver such that customized actions
can be done.</p>
<p>The overall observer is set to a range between 0 and 100 (percent). Every of the four
parallel function calls can add up to 25% of the total progress. Once the
overall progress reaches 100%, the call is considered to be finished.</p>
<p>Using the cancellation features of each progressObserver, this demo further
shows, that it is both possible to only cancel single function calls or the
entire call to all (currently running) sub-functions.</p>
<p>This demo uses the Thread class of python. Since python does not allow
real concurrent calls within python itself, we do not have to handle race conditions.</p>
<p>Hint: Algorithm calls of itom algorithms will release the Python GIL during the
entire time of the function call, therefore other Python thread can work in the
meantime.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itomUi</span> <span class="kn">import</span> <span class="n">ItomUi</span>
<span class="kn">from</span> <span class="nn">itom</span> <span class="kn">import</span> <span class="n">progressObserver</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>


<span class="k">class</span> <span class="nc">FunctionCall</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class wraps GUI items, the thread and observer of one function call.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">progress</span><span class="p">,</span> <span class="n">abortButton</span><span class="p">,</span> <span class="n">overallObserver</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="n">progress</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span> <span class="o">=</span> <span class="n">abortButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create the local observer for one function call</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span> <span class="o">=</span> <span class="n">progressObserver</span><span class="p">(</span>
            <span class="n">progressBar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">,</span> <span class="n">progressMinimum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">progressMaximum</span><span class="o">=</span><span class="mi">100</span>
        <span class="p">)</span>

        <span class="c1"># pass the overall observer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span> <span class="o">=</span> <span class="n">overallObserver</span>

        <span class="c1"># make several connections to signals of some objects with methods of this class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked()&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_abortButton_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="s2">&quot;progressValueChanged(int)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_progressValue_changed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="s2">&quot;progressTextChanged(QString)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_progressText_changed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="s2">&quot;cancellationRequested()&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_observer_cancellationRequested</span>
        <span class="p">)</span>

        <span class="c1"># True if the function is currently executed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inProgress</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Last reported progress value to the overallObserver [0, 25] in percent.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastReportedProgressValue</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the relevant GUI items to an idle state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">on_abortButton_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback if the abort button of this function is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># force the observer to cancel the running algorithm. The algorithm</span>
            <span class="c1"># has to regularily check for this request and terminate the algorithm</span>
            <span class="c1"># (with an exception set) as soon as possible.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">requestCancellation</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the complex function in a Python thread by executing self.run.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to request a cancellation of the algorithm call as public interface.</span>

<span class="sd">        This method is usually called if the global abort button is clicked.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">requestCancellation</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run method, executed in a thread.</span>

<span class="sd">        This method mainly starts the itom algorithm ``demoCancellationFunction``</span>
<span class="sd">        and passes the local observer to this function. If this observer should</span>
<span class="sd">        be requested to cancel, the algorithm will return with a RuntimeError.</span>

<span class="sd">        This exception is handled. At the end, the contribution to the global</span>
<span class="sd">        progress of this function is set to the maximum of 25% (Even in the case</span>
<span class="sd">        of a cancellation).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inProgress</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">filter</span><span class="p">(</span><span class="s2">&quot;demoCancellationFunction&quot;</span><span class="p">,</span> <span class="n">_observer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observer</span><span class="p">)</span>
            <span class="c1"># self.on_progressValue_changed(100)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="c1"># cancellation</span>
            <span class="k">pass</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># done or cancelled: report a full progress of 25%</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span><span class="o">.</span><span class="n">progressValue</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastReportedProgressValue</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lastReportedProgressValue</span> <span class="o">=</span> <span class="mi">25</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abortBtn</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inProgress</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_progressValue_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback if the local observer reports a new progress value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inProgress</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2">/100&quot;</span> <span class="o">%</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;done&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span><span class="o">.</span><span class="n">progressValue</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">value</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastReportedProgressValue</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lastReportedProgressValue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="k">def</span> <span class="nf">on_progressText_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback if the local observer reports a new progress text.</span>

<span class="sd">        Hint: it makes no real sense to change the toolTip. It is just an example.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="s2">&quot;toolTip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>

    <span class="k">def</span> <span class="nf">on_observer_cancellationRequested</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback if a cancellation has been requested to the local observer.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inProgress</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cancelled&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">DemoObserver</span><span class="p">(</span><span class="n">ItomUi</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Main GUI class that provides functionality to run for complex algorithms in parallel.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.&quot;&quot;&quot;</span>
        <span class="n">ItomUi</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;observedParallelFunctions.ui&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[]</span>
        <span class="p">)</span>  <span class="c1"># sets of widgets in the GUI for each parallel function execution</span>

        <span class="c1"># this overallObserver gives 25% to each of the 4 parallel function calls.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span> <span class="o">=</span> <span class="n">progressObserver</span><span class="p">(</span>
            <span class="n">progressBar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">progressAll</span><span class="p">,</span>
            <span class="n">progressMinimum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">progressMaximum</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="s2">&quot;progressValueChanged(int)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overallProgressChanged</span>
        <span class="p">)</span>

        <span class="c1"># Initialization of four FunctionCall objects for four parallel complex</span>
        <span class="c1"># function calls.</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">FunctionCall</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s2">&quot;lblRun</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s2">&quot;progressRun</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="s2">&quot;btnAbortRun</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># reset and hide all besides the start button</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnAbort</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">progressAll</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@ItomUi</span><span class="o">.</span><span class="n">autoslot</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_btnStart_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Auto-connected slot, called if the start button is clicked.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnAbort</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnStart</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">progressAll</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># resets the overall</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overallObserver</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="c1"># start the 4 threads with a short delay</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="nd">@ItomUi</span><span class="o">.</span><span class="n">autoslot</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_btnAbort_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Informs the algorithm call to interrupt as soon as possible.&quot;&quot;&quot;</span>

        <span class="c1"># cancels all four function calls</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnAbort</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnStart</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">progressAll</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">overallProgressChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback if the progressValueChanged signal of the overall progressObserver is emitted.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>
            <span class="c1"># all done</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnAbort</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">btnStart</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">progressAll</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demoObserverGui</span> <span class="o">=</span> <span class="n">DemoObserver</span><span class="p">()</span>
    <span class="n">demoObserverGui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.164 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-11-demos-itom-ui-demo-observedparallelfunctions-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/ee7ca6dc44422439be99ae45a1c3b87f/demo_observedParallelFunctions.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">demo_observedParallelFunctions.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/5b74ff1aa3d0fdf768770640e907dc8e/demo_observedParallelFunctions.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">demo_observedParallelFunctions.ipynb</span></code></a></p>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="demo_uiShape.html" class="btn btn-neutral float-left" title="12.1.10.8.25. UI shape" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="demo_uiMeasureToolMain.html" class="btn btn-neutral float-right" title="12.1.10.8.27. Measure tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://github.com/itom-project/itom/issues.
      <span class="lastupdated">Last updated on Sep 19, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>