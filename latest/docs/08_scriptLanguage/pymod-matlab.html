<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9.7. Python-Module matlab &mdash; itom Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.8. Reload modified modules" href="pymod-reload-modules.html" />
    <link rel="prev" title="9.6. Python package plotly" href="pymod-plotly.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> itom Documentation
          </a>
              <div class="version">
                4.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_releaseNotes/whats-new.html">1. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/introduction.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_installation/install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_gettingStarted/getting-started.html">4. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_itom_gui/gui.html">5. The itom User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_plots/plots.html">6. Plots and Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_extended_gui/extended_gui.html">7. Extending the user interface of <strong>itom</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_plugins/plugins.html">8. Plugins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="script-language.html">9. Python Scripting Language</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pymod-itom.html">9.1. Python-Module <strong>itom</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-dataObject.html">9.2. Array class DataObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-load-save-files.html">9.3. Save and load images and other files</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-popular-python-packages.html">9.4. Popular Python packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-matplotlib.html">9.5. Python package matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-plotly.html">9.6. Python package plotly</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9.7. Python-Module matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-reload-modules.html">9.8. Reload modified modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-limitations.html">9.9. Python Limitations in <strong>itom</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="pymod-problems-and-solutions.html">9.10. Python - common problems and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pytutorial.html">9.11. Python tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../09_reference/reference.html">10. itom Script Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_miscellaneous/miscellaneous.html">11. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_demos/demos.html">12. Demo scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_contributing/contributing.html">13. Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">itom Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="script-language.html"><span class="section-number">9. </span>Python Scripting Language</a> &raquo;</li>
      <li><span class="section-number">9.7. </span>Python-Module matlab</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/08_scriptLanguage/pymod-matlab.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-module-matlab">
<span id="pymod-matlab"></span><h1><span class="section-number">9.7. </span>Python-Module matlab<a class="headerlink" href="#python-module-matlab" title="Permalink to this heading">¶</a></h1>
<p><strong>itom</strong> provides the python module <strong>matlab</strong> that can be used to establish a remote control to the Matlab software.
Using this module, the following features are available:</p>
<ul class="simple">
<li><p>Remotely access Matlab via the matlab engine</p></li>
<li><p>Put and read variables from itom / python to and from the Matlab workspace.</p></li>
<li><p>Execute arbitrary Matlab commands like having executed them in the Matlab command window, including Matlab functions.</p></li>
<li><p>Integrate existing Matlab functions into a Python-scripted measurement system</p></li>
<li><p>…</p></li>
</ul>
<p>In order to use this <strong>matlab</strong> module, the following requirements have to be fulfilled:</p>
<ul class="simple">
<li><p>Matlab has to be installed in 32bit or 64bit, equal to <strong>itom</strong></p></li>
<li><p>The path <strong>{MatlabRoot}/bin/win64</strong> (or similar), containing the libraries <strong>libeng.dll</strong> and <strong>libmx.dll</strong> (or <strong>libeng.so</strong> and <strong>libmx.so</strong> under linux) must be in the PATH variable such that itom can find Matlab engine libraries during runtime. Please make sure, that the Qt bin directory is located in the PATH before the Matlab directory (ONLY if you have a self-compiled version of <strong>itom</strong>, for setup versions this restriction does not hold; The reason is, that the Matlab directory contains older versions of Qt libraries, too, that badly interfer with the itom Qt dependencies).</p></li>
<li><p>If the matlab libraries could be loaded but the session (see below) could not be started, you have to register the COM components of Matlab. See this link (for Windows users): <a class="reference external" href="http://de.mathworks.com/help/matlab/matlab_external/register-matlab-as-automation-server.html">http://de.mathworks.com/help/matlab/matlab_external/register-matlab-as-automation-server.html</a></p></li>
</ul>
<p>The following example is also included in the demo folder (<strong>demoMatlabEngine.py</strong>) and shows how to remotely control Matlab via itom:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matlab</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;itom is possibly compiled without Matlab support. This demo is not working&quot;</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">ex</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">matlab</span><span class="o">.</span><span class="n">MatlabSession</span><span class="p">()</span> <span class="c1">#a Matlab console is opened</span>

<span class="n">session</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="s2">&quot;myString&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="c1">#creates the string variable &#39;myString&#39; in the Matlab workspace with the value &#39;test&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;myString:&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="s2">&quot;myString&quot;</span><span class="p">))</span> <span class="c1">#returns &#39;test&#39; as answer in itom</span>
<span class="n">session</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;myArray&quot;</span><span class="p">,</span> <span class="n">dataObject</span><span class="o">.</span><span class="n">randN</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;int16&#39;</span><span class="p">))</span> <span class="c1">#creates a 2x3 random matrix in Matlab (name: myArray)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="s2">&quot;myArray&quot;</span><span class="p">)</span> <span class="c1">#returns the 2x3 array &#39;myArray&#39; from Matlab as Numpy array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="c1">#read the current working directory of matlab</span>
<span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;curDir = cd&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="s2">&quot;curDir&quot;</span><span class="p">))</span>

<span class="c1">#run directly executes the command (as string). This is the same than typing this command into the command line of Matlab.</span>
<span class="c1">#use this to also execute functions in Matlab. At first, send all required variables to the Matlab workspace, then execute a function</span>
<span class="c1">#that uses these variables.</span>

<span class="k">del</span> <span class="n">session</span> <span class="c1">#closes the session and deletes the instance</span>

<span class="c1">#session.close() only closes the session</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If Matlab is not properly installed, the opening of the MatlabSession will fail.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the command <strong>matlab.MatlabSesseion()</strong> returns the <strong>RuntimeError: error loading matlab engine: Cannot load library libeng.dll: The specified procedure could not be found.</strong>, there is a version conflict between librarys loaded by itom/MatlabSession.
One known conflict happens (Matlab version 2015), while the libraries <strong>icuio54.dll, icule54.dll, icuuc54.dll, icuin54.dll</strong> are loaded by the <strong>libeng.dll</strong>.
One possible workaround is to copy the library files <strong>icuio54.dll, icule54.dll, icuuc54.dll, icuin54.dll</strong> from the <strong>{MatlabRoot}/bin/win64</strong> folder into the <strong>{itomRoot}/lib</strong> folder.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pymod-plotly.html" class="btn btn-neutral float-left" title="9.6. Python package plotly" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pymod-reload-modules.html" class="btn btn-neutral float-right" title="9.8. Reload modified modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://github.com/itom-project/itom/issues.
      <span class="lastupdated">Last updated on Sep 19, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>