<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>13.2. Translations &mdash; itom Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="13.3. Python Docstrings" href="python_docstrings.html" />
    <link rel="prev" title="13.1. CMake Style Guide" href="cmake_style_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> itom Documentation
          </a>
              <div class="version">
                4.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_releaseNotes/whats-new.html">1. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/introduction.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_installation/install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_gettingStarted/getting-started.html">4. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_itom_gui/gui.html">5. The itom User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_plots/plots.html">6. Plots and Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_extended_gui/extended_gui.html">7. Extending the user interface of <strong>itom</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_plugins/plugins.html">8. Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08_scriptLanguage/script-language.html">9. Python Scripting Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_reference/reference.html">10. itom Script Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_miscellaneous/miscellaneous.html">11. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_demos/demos.html">12. Demo scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="contributing.html">13. Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cmake_style_guide.html">13.1. CMake Style Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">13.2. Translations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">13.2.1. General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-translations-for-the-itom-core-project">13.2.2. Adding translations for the itom core project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-or-creating-new-ts-files">13.2.3. Updating or creating new ts-files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#location-of-ts-files">13.2.4. Location of ts-files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#translating-plugins-or-designerplugins">13.2.5. Translating plugins or designerplugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python_docstrings.html">13.3. Python Docstrings</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">itom Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="contributing.html"><span class="section-number">13. </span>Contributing</a> &raquo;</li>
      <li><span class="section-number">13.2. </span>Translations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/12_contributing/translations.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="translations">
<span id="id1"></span><h1><span class="section-number">13.2. </span>Translations<a class="headerlink" href="#translations" title="Permalink to this heading">¶</a></h1>
<section id="general">
<h2><span class="section-number">13.2.1. </span>General<a class="headerlink" href="#general" title="Permalink to this heading">¶</a></h2>
<p>The basic language of itom or its plugins is English. All strings in the source code should be
written in English.</p>
<p>itom and its plugins can be translated to different other languages using the <em class="xref py py-obj">translation system
of Qt</em>.</p>
<p>The source translation strings of the core project of itom, its libraries (part of the itom SDK), designer plugins or
plugins are stored in different ts files whose filename should follow the pattern: <strong>libraryname_langid.ts</strong>,
where <strong>libraryname</strong> is a placeholder for the corresponding library or plugin and <strong>langid</strong> is a
placeholder for the particular language.</p>
<p>The language can have the following format:</p>
<ul class="simple">
<li><p><strong>de</strong> for German</p></li>
<li><p><strong>de_DE</strong> for German / Germany</p></li>
<li><p><strong>de_CH</strong> for German / Switzerland</p></li>
<li><p><strong>ko</strong> for Korean</p></li>
</ul>
<p>For language codes (small letters) and / or country codes (capital letters)
see <a class="reference external" href="https://docs.oracle.com/cd/E13214_01/wli/docs92/xref/xqisocodes.html">https://docs.oracle.com/cd/E13214_01/wli/docs92/xref/xqisocodes.html</a>.</p>
<p>Usually the source strings (in English) of the <strong>ts</strong> files are automatically created or updated by Qt’s tool <strong>lupdate</strong>. This tool
parses all corresponding source files (h, cpp, ui), detects all translatable strings and updates the ts files.</p>
<p>The translations itself are then comfortabily done in the tool QtLinguist of Qt.</p>
<p>The <strong>ts</strong> files are then compiled using Qt’s <strong>lrelease</strong> tool into their binary representation <strong>qm</strong>. Each
<strong>qm</strong> file has the same base filename than its original <strong>ts</strong> file and is put in several <strong>translation</strong> subfolders
of the install or build folder of itom or its plugins subfolder. This qm-file compilation is automatically
done during each build of the corresponding library.</p>
<p>For starting itom with another language, choose the desired language in the <a class="reference internal" href="../04_itom_gui/propertyDialog.html#gui-propertydialog-language"><span class="std std-ref">property dialog of itom</span></a>.
Possible languages depend on the available <strong>qm</strong> translation files:</p>
</section>
<section id="adding-translations-for-the-itom-core-project">
<h2><span class="section-number">13.2.2. </span>Adding translations for the itom core project<a class="headerlink" href="#adding-translations-for-the-itom-core-project" title="Permalink to this heading">¶</a></h2>
<p>Adding new or existing translations for different languages to the itom core project or some
of its plugins or designerplugins is usually done
in the CMake configuration process.</p>
<p>Select the desired language codes (see above) as semicolon-separated string to the CMake variable
<strong>ITOM_LANGUAGES</strong>. Since English is the default language, never add <strong>en</strong> to this string.</p>
<p>Example:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="no">ITOM_LANGUAGES</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">de</span><span class="p">;</span><span class="nb">fr</span><span class="w"></span>
<span class="c">#this includes translations for German and French (in addition to English)</span>
</pre></div>
</div>
<p>If you press <strong>Configure</strong> in CMake after having changed the <strong>ITOM_LANGUAGES</strong> variable, CMake checks
if the corresponding <strong>ts</strong> files are available for all desired languages and all translatable libraries, that
belong to the itom core project.</p>
<p>There is one common CMake error message, that might occur when setting new languages:</p>
<p>Error (ITOM_LANGUAGES = it):</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>CMake Error at cmake/ItomBuildMacros.cmake:664 (MESSAGE):
  Source translation file
  &#39;C:/itom/sources/itom/Qitom/translation/qitom_it.ts&#39; for language &#39;it is
  missing.  Please create this file first or set ITOM_UPDATE_TRANSLATIONS to
  ON
Call Stack (most recent call first):
  Qitom/CMakeLists.txt:759 (itom_library_translation)
</pre></div>
</div>
<p>CMake could not find the relevant Italian translation file <strong>qitom_it.ts</strong>. Since the additional CMake
variable <strong>ITOM_UPDATE_TRANSLATIONS</strong> is likely to be set to <strong>OFF</strong>, itom is not allowed to automatically
create an initial version of this file, such that the error is raised.</p>
<p><strong>Solution:</strong> Set <strong>ITOM_UPDATE_TRANSLATIONS</strong> to <strong>ON</strong> if you add new languages. Then a bare version of
a <strong>ts</strong> file is created for each non-existing language and Qt’s <strong>lupdate</strong> process is triggered when
building each library. This also affects all existing <strong>ts</strong> file, such that they are also updated by new
translatable strings in the source code.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not recommended to manually create a new ts-file for a new language by copying an existing ts-file
from another language, since each ts-file contains xml-content with the language ID as subcontent. If this
language ID does not fit to the suffix of the filename, the <strong>lupdate</strong> process to update the translatable
strings in this file will fail.</p>
</div>
</section>
<section id="updating-or-creating-new-ts-files">
<h2><span class="section-number">13.2.3. </span>Updating or creating new ts-files<a class="headerlink" href="#updating-or-creating-new-ts-files" title="Permalink to this heading">¶</a></h2>
<p>Usually, the itom build process does not influence any ts-files during the build, hence, no-existing ts-files
are not updated nor new ts-files for new languages in the CMake variable <strong>ITOM_LANGAUGES</strong> are created. However
the binary compilation of qm-files from existing ts-files is always started when building the particular
library.</p>
<p>The source translation update process can be triggered and controlled by the two boolean CMake variables
<strong>ITOM_UPDATE_TRANSLATIONS</strong> and <strong>ITOM_UPDATE_TRANSLATIONS_REMOVE_UNUSED_STRINGS</strong>.</p>
<p>Set <strong>ITOM_UPDATE_TRANSLATIONS</strong> to force the itom (or plugins) build process to always update or
create the <strong>ts</strong>-files for all desired languages (based on <strong>ITOM_LANGAUGES</strong>) using the tool
<strong>lupdate</strong> of Qt. This is done by a special build project, whose name is equal to the corresponding
library, followed by the suffix <strong>_translation</strong> (e.g. <strong>itomCommonQtLib_translation</strong> for the library
<strong>itomCommonQtLib</strong>. The original library project depends on its <em>_translation</em>-project, such that this
is always created before the library itself.</p>
<p>Usually, the <strong>lupdate</strong> tool parses all header, source and user-interface files of the library for translatable
strings and adds them to the <strong>ts</strong> file, if they do not exist yet. However <strong>lupdate</strong> does not remove unused
strings from the <strong>ts</strong> file. This can be changed by also setting <strong>ITOM_UPDATE_TRANSLATIONS_REMOVE_UNUSED_STRINGS</strong> to
<strong>ON</strong>.</p>
<p>Please commit all changed <strong>ts</strong> files to the Git repository of the corresponding library (or plugin).</p>
<p>If <strong>ITOM_UPDATE_TRANSLATIONS</strong> is <strong>ON</strong> and a <strong>ts</strong> file has a wrong format, the following CMake
error might occur:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>CMake Warning at cmake/ItomBuildMacros.cmake:745 (message):
  - The existing ts-file
  C:/itom/sources/itom/AddInManager/translation/addinmanager_fr.ts does not
  contain the required language &#39;fr&#39;, but &#39;de&#39;.  The lupdate process might
  fail.  Either fix the file or delete it and re-configure to let CMake
  rebuild an empty, proper ts file.
Call Stack (most recent call first):
  cmake/ItomBuildMacros.cmake:656 (itom_qt5_create_translation)
  AddInManager/CMakeLists.txt:96 (itom_library_translation)
</pre></div>
</div>
<p>In this case, the translation system expected a french translation file <strong>addinmanager_fr.ts</strong>, however the
file was a copy from the german version <strong>addinmanager_de.ts</strong>, such that the internal xml content of the
file was invalid. If this happens, <strong>lupdate</strong> will fail later. To fix this, remove the file and run CMake
again or fix the content of the file.</p>
</section>
<section id="location-of-ts-files">
<h2><span class="section-number">13.2.4. </span>Location of ts-files<a class="headerlink" href="#location-of-ts-files" title="Permalink to this heading">¶</a></h2>
<p>Usually the ts-files are always located in a <strong>translation</strong> subfolder of the sources
of the wrapped library. These are for the itom core project:</p>
<ul class="simple">
<li><p>sources/itom/AddInManager/translation</p></li>
<li><p>sources/itom/itomCommonQt/translation</p></li>
<li><p>sources/itom/itomWidgets/translation</p></li>
<li><p>sources/itom/plot/translation</p></li>
<li><p>sources/itom/shape/translation</p></li>
<li><p>sources/itom/qitom/translation</p></li>
</ul>
<p>The translation files for plugins are always located in a subfolder <strong>translation</strong> of
the particular plugin sources. The same holds for designerplugins.</p>
<p>When deploying itom, the qm-files are located in the following folders:</p>
<ul class="simple">
<li><p>itom core project: itom-subfolder <strong>translation</strong></p></li>
<li><p>designer plugins: itom-subfolder <strong>designer/translation</strong></p></li>
<li><p>plugin (name: targetname): itom-subfolder <strong>plugins/&lt;targetname&gt;/translation</strong></p></li>
</ul>
</section>
<section id="translating-plugins-or-designerplugins">
<h2><span class="section-number">13.2.5. </span>Translating plugins or designerplugins<a class="headerlink" href="#translating-plugins-or-designerplugins" title="Permalink to this heading">¶</a></h2>
<p>While the itom core project can directly be translated by setting the mentioned CMake variables
<strong>ITOM_LANGUAGES</strong>, <strong>ITOM_UPDATE_TRANSLATIONS</strong> and optionally <strong>ITOM_UPDATE_TRANSLATIONS_REMOVE_UNUSED_STRINGS</strong>,
some additional steps have to be done for translating plugins and / or designerplugins.</p>
<p>Besides configuring the mentioned CMake variables, you also have to set the following exemplary
lines into the CMakeLists.txt file of the particular plugin:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#translation</span>
<span class="nf">set(</span><span class="no">FILES_TO_TRANSLATE</span><span class="w"> </span><span class="o">${</span><span class="nt">PLUGIN_SOURCES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nt">PLUGIN_HEADERS</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nt">PLUGIN_UI</span><span class="o">}</span><span class="nf">)</span><span class="w"></span>
<span class="nf">itom_library_translation(</span><span class="no">QM_FILES</span><span class="w"> </span><span class="no">TARGET</span><span class="w"> </span><span class="o">${</span><span class="nt">target_name</span><span class="o">}</span><span class="w"> </span><span class="no">FILES_TO_TRANSLATE</span><span class="w"> </span><span class="o">${</span><span class="nt">FILES_TO_TRANSLATE</span><span class="o">}</span><span class="nf">)</span><span class="w"></span>
</pre></div>
</div>
<p>The <strong>FILES_TO_TRANSLATE</strong> list will contain all source (cpp), header (h) or user interface (ui) files,
that should be parsed for new files. The translation project itself will be created by the itom macro
<strong>itom_library_translation</strong>, provided by <strong>ItomBuildMacros.cmake</strong>. This will then create ts
files in a <strong>translation</strong> subfolder of the plugin source folder whose particular names are <strong>targetname_langid.ts</strong>,
where <strong>targetname</strong> corresponds to the project name of the plugin and <strong>langid</strong> is each language ID, contained
in the semicolon-separated list <strong>ITOM_LANGUAGES</strong>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cmake_style_guide.html" class="btn btn-neutral float-left" title="13.1. CMake Style Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="python_docstrings.html" class="btn btn-neutral float-right" title="13.3. Python Docstrings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, Institut fuer Technische Optik (ITO), University Stuttgart. Bug report: https://github.com/itom-project/itom/issues.
      <span class="lastupdated">Last updated on Sep 19, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>